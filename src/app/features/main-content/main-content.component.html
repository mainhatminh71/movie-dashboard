<div class="main-content-wrapper">
  <div class="content-header">
    <div class="category-tabs">
      <button class="tab" [class.active]="activeTab === 'movies'" (click)="(switchTab('movies'))">
        <span>Movies</span>
        <div class="active-indicator" *ngIf="activeTab === 'movies'"></div>
      </button>
      <button class="tab" [class.active]="activeTab === 'tvshows'" (click)="(switchTab('tvshows'))">
        <span>TV Shows</span>
        <div class="active-indicator" *ngIf="activeTab === 'tvshows'"></div>
      </button>
    </div>
    <div class="search-filter">
      <div class="search-bar">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M9 17C13.4183 17 17 13.4183 17 9C17 4.58172 13.4183 1 9 1C4.58172 1 1 4.58172 1 9C1 13.4183 4.58172 17 9 17Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M19 19L14.65 14.65" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <input 
          type="text" 
          class="search-input" 
          [placeholder]="'Search for ' + (activeTab === 'movies' ? 'movies' : 'TV shows') + '...'"
          [value]="searchQuery"
          (input)="onSearchInput($event)"
          (keydown.enter)="onSearchKeyDown($event)"
          [attr.aria-label]="'Search for ' + (activeTab === 'movies' ? 'movies' : 'TV shows')"
        />
      </div>
      <div class="filter-icon">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M3 5H17M7 10H17M10 15H17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <circle cx="2" cy="5" r="2" fill="currentColor"/>
          <circle cx="6" cy="10" r="2" fill="currentColor"/>
          <circle cx="9" cy="15" r="2" fill="currentColor"/>
        </svg>
      </div>
    </div>
  </div>

  @if (activeTab === 'movies' && heroMovies.length > 0 && getCurrentHeroMovie()) {
    @let currentMovie = getCurrentHeroMovie()!;
    <div class="hero-section">
      <div 
        class="hero-card"
        (touchstart)="onTouchStart($event)"
        (touchmove)="onTouchMove($event)"
        (touchend)="onTouchEnd($event)"
        (mousedown)="onMouseDown($event)"
        (mousemove)="onMouseMove($event)"
        (mouseup)="onMouseUp($event)"
        (mouseleave)="onMouseLeave()"
      >
        <div class="hero-background" [style.background-image]="'url(' + (currentMovie.backdrop_path | imageUrl:'w1280') + ')'" [@fadeIn]="currentHeroIndex"></div>
        <div class="hero-content" [@slideIn]="currentHeroIndex">
          <div class="hero-left">
            <h1 class="hero-title">{{ currentMovie.title || 'Loading...' }}</h1>
            @if (currentMovie.overview) {
              <p class="hero-description">{{ currentMovie.overview }}</p>
            }
            <div class="hero-meta">
              <span class="hero-year">{{ currentMovie.release_date | year }}</span>
              @if (currentMovie.vote_average) {
                <span class="hero-rating">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
                  </svg>
                  {{ currentMovie.vote_average | rating:1 }}
                </span>
              }
            </div>
          </div>
          <div class="hero-right">
            @if (currentMovie.poster_path) {
              <img 
                [src]="currentMovie.poster_path | imageUrl:'w500'" 
                [alt]="currentMovie.title"
                [title]="currentMovie.title + ' poster'"
                class="hero-poster"
                (error)="onImageError($event)"
              />
            } @else {
              <div class="hero-image-placeholder"></div>
            }
          </div>
        </div>
        <div class="hero-actions">
          <button mat-raised-button class="hero-btn watchlist-btn" (click)="navigateToMovieDetails(currentMovie.id)" [attr.aria-label]="'Add ' + currentMovie.title + ' to watchlist'">
            <mat-icon>bookmark_add</mat-icon>
            <span>Watchlist</span>
          </button>
          <button mat-raised-button color="primary" class="hero-btn watch-now-btn" (click)="navigateToMovieDetails(currentMovie.id)" [attr.aria-label]="'Watch ' + currentMovie.title">
            <mat-icon>play_arrow</mat-icon>
            <span>Watch Now</span>
          </button>
        </div>
        <div class="carousel-controls">
          <button mat-icon-button class="carousel-arrow left-arrow" (click)="prevHero()" aria-label="Previous movie">
            <mat-icon>chevron_left</mat-icon>
          </button>
          <button mat-icon-button class="carousel-arrow right-arrow" (click)="nextHero()" aria-label="Next movie">
            <mat-icon>chevron_right</mat-icon>
          </button>
        </div>
        <div class="carousel-indicators">
          @for (movie of heroMovies; track movie.id; let i = $index) {
            <div 
              class="indicator" 
              [class.active]="i === currentHeroIndex"
              (click)="goToHero(i)"
              [attr.aria-label]="'Go to slide ' + (i + 1)"
            ></div>
          }
        </div>
      </div>
    </div>
  } @else if (activeTab === 'tvshows' && heroTVShows.length > 0 && getCurrentHeroTVShow()) {
    @let currentTVShow = getCurrentHeroTVShow()!;
    <div class="hero-section">
      <div 
        class="hero-card"
        (touchstart)="onTouchStart($event)"
        (touchmove)="onTouchMove($event)"
        (touchend)="onTouchEnd($event)"
        (mousedown)="onMouseDown($event)"
        (mousemove)="onMouseMove($event)"
        (mouseup)="onMouseUp($event)"
        (mouseleave)="onMouseLeave()"
      >
        <div class="hero-background" [style.background-image]="'url(' + (currentTVShow.backdrop_path | imageUrl:'w1280') + ')'" [@fadeIn]="currentHeroIndex"></div>
        <div class="hero-content" [@slideIn]="currentHeroIndex">
          <div class="hero-left">
            <h1 class="hero-title">{{ currentTVShow.name || 'Loading...' }}</h1>
            @if (currentTVShow.overview) {
              <p class="hero-description">{{ currentTVShow.overview }}</p>
            }
            <div class="hero-meta">
              <span class="hero-year">{{ currentTVShow.first_air_date | year }}</span>
              @if (currentTVShow.vote_average) {
                <span class="hero-rating">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
                  </svg>
                  {{ currentTVShow.vote_average | rating:1 }}
                </span>
              }
            </div>
          </div>
          <div class="hero-right">
            @if (currentTVShow.poster_path) {
              <img 
                [src]="currentTVShow.poster_path | imageUrl:'w500'" 
                [alt]="currentTVShow.name"
                [title]="currentTVShow.name + ' poster'"
                class="hero-poster"
                (error)="onImageError($event)"
              />
            } @else {
              <div class="hero-image-placeholder"></div>
            }
          </div>
        </div>
        <div class="hero-actions">
          <button mat-raised-button class="hero-btn watchlist-btn" (click)="navigateToTVDetails(currentTVShow.id)" [attr.aria-label]="'Add ' + currentTVShow.name + ' to watchlist'">
            <mat-icon>bookmark_add</mat-icon>
            <span>Watchlist</span>
          </button>
          <button mat-raised-button color="primary" class="hero-btn watch-now-btn" (click)="navigateToTVDetails(currentTVShow.id)" [attr.aria-label]="'Watch ' + currentTVShow.name">
            <mat-icon>play_arrow</mat-icon>
            <span>Watch Now</span>
          </button>
        </div>
        <div class="carousel-controls">
          <button mat-icon-button class="carousel-arrow left-arrow" (click)="prevHero()" aria-label="Previous TV show">
            <mat-icon>chevron_left</mat-icon>
          </button>
          <button mat-icon-button class="carousel-arrow right-arrow" (click)="nextHero()" aria-label="Next TV show">
            <mat-icon>chevron_right</mat-icon>
          </button>
        </div>
        <div class="carousel-indicators">
          @for (tvShow of heroTVShows; track tvShow.id; let i = $index) {
            <div 
              class="indicator" 
              [class.active]="i === currentHeroIndex"
              (click)="goToHero(i)"
              [attr.aria-label]="'Go to slide ' + (i + 1)"
            ></div>
          }
        </div>
      </div>
    </div>
  }

  <div class="movies-section">
    <div class="section-header">
      <div class="section-title-wrapper">
        <h2 class="section-title">
          <span class="title-text" *ngIf="activeTab==='movies'">Popular Movies</span>
          <span class="title-text" *ngIf="activeTab==='tvshows'">Popular TVShows</span>
          <span class="title-accent"></span>
        </h2>
        <p class="section-subtitle">Trending now</p>
      </div>
      <button class="view-all-btn">
        <span>View All</span>
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
    </div>
    <div class="movies-grid">
      <!-- Movies -->
      @if (activeTab === 'movies') {
        @for (movie of popularMovies; track movie.id) {
          <div class="movie-card" (click)="navigateToMovieDetails(movie.id)">
            <div class="movie-poster">
              <img [src]="movie.poster_path | imageUrl:'w300'" [alt]="movie.title" [title]="movie.title">
              <div class="poster-overlay"></div>
              <div class="movie-badge popular-badge">Popular</div>
            </div>
            <div class="movie-info">
              <h3 class="movie-title">{{movie.title}}</h3>
              <div class="movie-meta">
                <span class="movie-year">{{movie.release_date | year}}</span>
                <div class="rating-wrapper">
                  <svg class="star-icon" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M7 0L8.5716 5.33688L14 5.33688L9.7143 8.62624L11.2859 13.9631L7 10.6738L2.71411 13.9631L4.28571 8.62624L0 5.33688L5.42839 5.33688L7 0Z" fill="currentColor"/>
                  </svg>
                  <span class="movie-rating">{{movie.vote_average | rating:1}}</span>
                </div>
              </div>
            </div>
            <div class="card-hover-effect"></div>
          </div>
        }
      }
      <!-- TV Shows -->
      @if (activeTab === 'tvshows') {
        @for (tvShow of popularTVShows; track tvShow.id) {
          <div class="movie-card" (click)="navigateToTVDetails(tvShow.id)">
            <div class="movie-poster">
              <img [src]="tvShow.poster_path | imageUrl:'w300'" [alt]="tvShow.name" [title]="tvShow.name">
              <div class="poster-overlay"></div>
              <div class="movie-badge popular-badge">Popular</div>
            </div>
            <div class="movie-info">
              <h3 class="movie-title">{{tvShow.name}}</h3>
              <div class="movie-meta">
                <span class="movie-year">{{tvShow.first_air_date | year}}</span>
                <div class="rating-wrapper">
                  <svg class="star-icon" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M7 0L8.5716 5.33688L14 5.33688L9.7143 8.62624L11.2859 13.9631L7 10.6738L2.71411 13.9631L4.28571 8.62624L0 5.33688L5.42839 5.33688L7 0Z" fill="currentColor"/>
                  </svg>
                  <span class="movie-rating">{{tvShow.vote_average | rating:1}}</span>
                </div>
              </div>
            </div>
            <div class="card-hover-effect"></div>
          </div>
        }
      }
    </div>
    
    <!-- Pagination -->
    <div class="pagination-wrapper">
      <!-- Movies Pagination -->
      <div class="pagination" *ngIf="activeTab === 'movies' && totalMoviesPages > 1">
        <button 
          class="pagination-btn" 
          [class.disabled]="currentMoviesPage === 1"
          (click)="goToMoviesPage(currentMoviesPage - 1)"
          [disabled]="currentMoviesPage === 1"
          title="Previous page">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M10 12L6 8L10 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        
        <div class="pagination-pages">
          <button
            *ngFor="let page of getPagesArray(totalMoviesPages)"
            class="pagination-page"
            [class.active]="page === currentMoviesPage"
            (click)="goToMoviesPage(page)">
            {{page}}
          </button>
        </div>
        
        <button 
          class="pagination-btn" 
          [class.disabled]="currentMoviesPage === totalMoviesPages"
          (click)="goToMoviesPage(currentMoviesPage + 1)"
          [disabled]="currentMoviesPage === totalMoviesPages"
          title="Next page">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>

      <!-- TV Shows Pagination -->
      <div class="pagination" *ngIf="activeTab === 'tvshows' && totalTVShowsPages > 1">
        <button 
          class="pagination-btn" 
          [class.disabled]="currentTVShowsPage === 1"
          (click)="goToTVShowsPage(currentTVShowsPage - 1)"
          [disabled]="currentTVShowsPage === 1"
          title="Previous page">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M10 12L6 8L10 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        
        <div class="pagination-pages">
          <button
            *ngFor="let page of getPagesArray(totalTVShowsPages)"
            class="pagination-page"
            [class.active]="page === currentTVShowsPage"
            (click)="goToTVShowsPage(page)">
            {{page}}
          </button>
        </div>
        
        <button 
          class="pagination-btn" 
          [class.disabled]="currentTVShowsPage === totalTVShowsPages"
          (click)="goToTVShowsPage(currentTVShowsPage + 1)"
          [disabled]="currentTVShowsPage === totalTVShowsPages"
          title="Next page">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
    </div>
  </div>

</div>


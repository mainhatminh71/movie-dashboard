<div class="discover-container">
  <!-- Header Section -->
  <div class="discover-header">
    <h1 class="page-title">Discover</h1>
    <p class="page-subtitle">Find your next favorite {{ activeTab() === 'movies' ? 'movie' : 'TV show' }}</p>
  </div>

  <!-- Tabs -->
  <div class="tabs-container">
    <button 
      class="tab-btn"
      [class.active]="activeTab() === 'movies'"
      (click)="switchTab('movies')"
    >
      Movies
    </button>
    <button 
      class="tab-btn"
      [class.active]="activeTab() === 'tvshows'"
      (click)="switchTab('tvshows')"
    >
      TV Shows
    </button>
  </div>

  <!-- Search and Filters Section -->
  <div class="filters-section">
    <!-- Search Bar -->
    <div class="search-container">
      <div class="search-input-wrapper">
        <label for="discover-search-input" class="sr-only">Search for {{ activeTab() === 'movies' ? 'movies' : 'TV shows' }}</label>
        <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M10.5 10.5L15.5 15.5M21 11C21 16.5228 16.5228 21 11 21C5.47715 21 1 16.5228 1 11C1 5.47715 5.47715 1 11 1C16.5228 1 21 5.47715 21 11Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <input 
          id="discover-search-input"
          type="text" 
          class="search-input" 
          [placeholder]="'Search for ' + (activeTab() === 'movies' ? 'movies' : 'TV shows') + '...'"
          [value]="searchQuery()"
          (input)="onSearchInput($event)"
          [attr.aria-label]="'Search for ' + (activeTab() === 'movies' ? 'movies' : 'TV shows')"
        />
        @if (searchQuery()) {
          <button class="clear-search-btn" (click)="clearSearch()" aria-label="Clear search">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        }
      </div>
    </div>

    <!-- Genre Filter Section -->
    <div class="genre-section">
      <label class="filter-label">Genres</label>
      <div class="genre-chips">
        @for (genre of allGenres(); track genre.id) {
          <app-filter-chip
        [label]="genre.name"
        [isActive]="selectedGenreIDs().includes(genre.id)"
        (clicked)="toggleGenre(genre.id)"
      />
        }
      </div>
    </div>

    <div class="filters-row">
      <div class="filter-group">
        <app-year-select
          [selectedYear]="selectedYear()"
          (yearChange)="onYearChange($event)"
        />
      </div>
    
      <div class="filter-group">
        <app-rating-slider
          [value]="minRating()"
          [min]="0"
          [max]="10"
          [step]="0.5"
          (valueChange)="onRatingChange($event)"
        />
      </div>
    
      @if (hasActiveFilters()) {
        <button class="clear-filters-btn" (click)="clearFilters()">
          Clear All Filters
        </button>
      }
    </div>
  </div>

  <div class="results-section">
    @if (loading()) {
      <div class="loading-container">
        <div class="spinner"></div>
        <p class="loading-text">Loading {{ activeTab() === 'movies' ? 'movies' : 'TV shows' }}...</p>
      </div>
    } @else if (error()) {
      <div class="error-container">
        <svg class="error-icon" width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 8V12M12 16H12.01M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <p class="error-message">{{ error() }}</p>
        <button class="retry-btn" (click)="loadContent()">Try Again</button>
      </div>
    } @else if (filteredContent().length === 0) {
      <div class="empty-container">
        <svg class="empty-icon" width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 6H20M4 12H20M4 18H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <p class="empty-message">No {{ activeTab() === 'movies' ? 'movies' : 'TV shows' }} found</p>
        <p class="empty-submessage">Try adjusting your filters or search query</p>
        @if (hasActiveFilters()) {
          <button class="clear-filters-btn" (click)="clearFilters()">Clear Filters</button>
        }
      </div>
    } @else {
      <div class="movies-grid">
        @for (item of filteredContent(); track item.id) {
          <app-movie-card 
            [movie]="item"
            [showRating]="true"
            size="medium"
            (cardClick)="navigateToDetails(item.id)"
          />
        }
      </div>
      <div class="results-count">
        <p>Found {{ filteredContent().length }} {{ activeTab() === 'movies' ? 'movie' : 'TV show' }}{{ filteredContent().length !== 1 ? 's' : '' }}</p>
      </div>
    }
  </div>
</div>
